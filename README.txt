【Tracking Analysis for Physics】

---

■ 概要
スマホ等で撮影した動画から、物体の位置と時間を手動で取得し、物理実験や解析に利用できるブラウザベースのトラッキングツールです。

---

■ 主な機能（2024年7月時点・複数物体追跡/Undo/UI改善版）
- 動画ファイルの読み込み（mp4, mov等）
- 原点・スケール（長さ・回転）設定
- フレームレート設定、解析範囲（開始・終了フレーム）指定
- ズーム・ドラッグによる動画拡大・移動
- 手動トラッキング（クリックで物体位置を記録、マーカー表示、1物体/2物体対応）
- 記録データのCSV出力（秒単位、ヘッダー付き、小数点以下3桁、座標系・符号・順序は画面表示と一致）
- Undo機能：追跡モード中はガイドテキスト横にUndoボタン＋Zキー/BackspaceでもUndo可能
- UIは日本語対応
- ウィンドウリサイズや縦長動画にも完全対応（動画・canvas・スライダーが常にウィンドウ内に収まる）
- ロゴ・タイトル・UIデザインの改善

---

■ 今後の拡張ポイント
- 複数物体（2物体以上）の同時トラッキング（次のプロジェクト！）
- 記録点のやり直し・削除機能
- 自動トラッキング（画像処理）
- 英語UI対応
- 記録データのグラフ表示

---

■ 使用方法
1. 「Choose File」で動画ファイルを選択
2. 「原点設定」→canvas上で原点をクリック
3. 「スケール設定」→canvas上で物差しの始点・終点をクリック→長さ(m)を入力
4. フレームレート・解析範囲を必要に応じて設定
5. ズーム（＋−リセット）やドラッグで動画を見やすく調整
6. 「手動追跡モード」ON→物体の位置をクリック（1クリックごとにフレーム進む）
7. 追跡モード中はガイド横のUndoボタンまたはZ/Backspaceで直前の点を取り消し
8. 「CSV出力」で記録データをダウンロード

---

■ 注意事項
- ブラウザのキャッシュに注意。更新時は「Shift+リロード」推奨
- 動画ファイルはローカルでのみ処理され、サーバー送信なし

---

■ バージョン管理・今後の展望
- 2024年7月：複数物体手動追跡・Undo/UI改善版 完成
- 2025年：自動トラッキング・グラフ表示・英語UI等の拡張予定

---

【Tracking Analysis for Physics 進捗まとめ】

■ 機能概要
- ブラウザ上で動画ファイルを読み込み、手動で物体の位置をフレームごとに記録できる。
- 物体数は1または2（将来的に拡張可）。
- 原点・スケール線を動画上で指定し、物理座標系（X:右, Y:上, 画面基準）で出力。
- ズーム・パン機能あり。
- 記録データはCSVでエクスポート可能。

■ UI
- ファイル選択、原点設定、スケール設定、物体数選択、追跡開始、CSV出力、やり直し、再生/停止/フレーム送り戻し等のボタン。
- 追跡モード中のみUndoボタンが表示される。
- 物体ごとに色分けされたマーカーで位置を表示。
- 座標軸は常にX軸が右、Y軸が上（スケール線の微小角度補正のみ反映）。

■ 追跡・Undo/やり直し
- 追跡モードでは、各フレームごとに物体1→物体2…の順でクリック。
- 「Undo」ボタン：直前に打った点だけを消す（2物体追跡なら2つ目→1つ目の順でundo）。
- 「1フレーム戻る」ボタン：そのフレームの全物体の点を消し、物体1から再入力できる。
- どちらのundoも追跡モード中のみ有効。

■ CSV出力
- time, y1, x1, y2, x2... の順で出力（現状、yとxが逆になっている可能性あり。要再確認）。

■ 既知の課題
- CSV出力の座標値が、画面の座標軸表示と完全に一致していない可能性がある（次回要修正）。
- Undo/やり直しのUI・挙動は今後さらに改善の余地あり。

■ その他
- UIの細部（ファイル選択ボタンの位置など）も調整済み。
- GitHubへのpushはまだ行っていない。

---

2024/7/1 時点の進捗まとめ

---

■ 2024年7月の主なアップデート
- 複数物体（2物体まで）の同時トラッキング対応
- UndoボタンのUIをガイドテキスト横＋ショートカット対応に大幅改善
- CSV出力の座標順・符号・スケール線向き依存のバグ修正（画面表示と完全一致）
- スライダーの端はみ出しバグ修正、ウィンドウリサイズ追従
- 解析終了フレームでの自動停止の信頼性向上

---

■ 既知の課題（2024年7月時点）
- Undo/やり直しのUI・挙動は今後さらに改善の余地あり
- 自動トラッキング（画像処理）は未実装
- 英語UI対応、記録データのグラフ表示は未実装

---
